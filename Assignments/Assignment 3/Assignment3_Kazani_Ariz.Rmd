---
title: "Assignment 3"
author: "Ariz Kazani"
date: "`r Sys.Date()`"
output: pdf_document
---

# Assignment 3

## Name: Ariz Kazani

## Student ID: 101311311

------------------------------------------------------------------------

# Notes

```{r}
# Libraries

# NOTE: if you do not have any of the below libraries installed, un-comment the line and run it
# install.packages("rmarkdown")
library(rmarkdown)

# install.packages("ggplot2")
library(ggplot2)

# install.packages("patchwork")
library(patchwork)

# install.packages("dplyr")
library(dplyr)

# install.packages("tidyr")
library(tidyr)

# install.packages("gapminder")
library(gapminder)
```

------------------------------------------------------------------------

# Solutions

------------------------------------------------------------------------

## 1.

c

```{r}
simulateDiceRole <- function(n) {
  outcome <- sample(1:12, n, replace = TRUE)
  return(outcome)
}

outcome <- simulateDiceRole(500)

outcome
```

### B. Calculate the empirical probability of rolling a prime number or a multiple of 3 based on the simulation results. Is this consistent with what you would expect?

```{r}
allOutcome <- table(outcome)
allOutcome

POM3 <- c(2, 3, 5, 6, 7, 9, 11, 12)

sumPrimeORm3 <- sum(allOutcome[POM3])
sumPrimeORm3

EP <- sumPrimeORm3/500

cat("Expected Probability", 8/12, "\n")
cat("Simulated Probability", EP, "\n")
```

When I initially ran the simulation, the probability I ended up with was 0.67 which is very very close to the expected probability of 0.66666666...

### C. Plot a bar chart showing the frequencies of each outcome (1 through 12) obtained from the simulation.

```{r}
barplot(allOutcome,
        main = "Frequency of outcomes when rolling a 12 sided die 12 times",
        xlab = "Outcome",
        ylab = "Frequency",
        col = "blue",)
```

------------------------------------------------------------------------

## 2.

### A. Write R code to calculate the probability of getting at least 4 heads in 8 coin tosses, assuming ð‘ = 0.6.

```{r}
pminFourHead <- 1 - pbinom(3, size = 8, prob = 0.6)
pminFourHead
```

### B. Compute the cumulative probability of getting 4 or more heads.

```{r}
# this question did not specify the p value so I'm going to assume it's 0.5
pminFourHead <- 1 - pbinom(3, size = 8, prob = 0.5)
pminFourHead
```

### C. Plot the probability function (PMF) and cumulative distribution function (CDF) on the same graph.

```{r}
index <- 0:8

pmf <- dbinom(index, size = 8, prob = 0.5)
cdf <- pbinom(index, size = 8, prob = 0.5)

df <- data.frame(index, pmf, cdf)

ggplot(df, aes(x = index, y = pmf)) +
  geom_bar(stat = "identity") +
  geom_line(aes(y = cdf)) +
  labs(title = "Probability Mass Function and Cumulative Distribution Function", x = "Number of Heads", y = "Probability") +
  theme_classic()
```

------------------------------------------------------------------------

## 3.

### A. Use R to compute the probability of observing exactly 3 events in a given time interval, assuming ðœ† = 2.5 events per hour.

```{r}
POE3E <- dpois(3, 2.5)
POE3E
```

### B. Compute the cumulative probability of observing 3 or fewer events.

```{r}
POE3EOF <- ppois(3, 2.5)
POE3EOF
```

### C. Plot the probability function (PMF) and cumulative distribution function (CDF) on the same graph.

```{r}
# Create a sequence of events
events <- 0:qpois(0.99, 2.5)

# Compute PMF and CDF values
pmf_values <- dpois(events, 2.5)
cdf_values <- ppois(events, 2.5)

# Create a data frame for plotting
data <- data.frame(events, pmf_values, cdf_values)

# Plot PMF and CDF on the same graph
ggplot(data, aes(x = events)) +
  geom_bar(aes(y = pmf_values), stat = "identity", fill = "blue") +
  geom_line(aes(y = cdf_values), color = "red") +
  labs(title = "Poisson Distribution (Î» = 2.5)",
       x = "Number of Events",
       y = "Probability") +
  theme_classic() +
  scale_y_continuous(sec.axis = sec_axis(~., name = "Cumulative Probability"))
```

------------------------------------------------------------------------

## 4.

Write a function to implement the Linear Congruence Method for pseudo random numbers (PRN). The function should take a length ð‘›, the parameters ð‘š, ð‘Ž, and ð‘ as well as the seed ð‘‹0 as input and should return a vector ð‘‹ = (ð‘‹1, ð‘‹2, â€¦ , ð‘‹ð‘›). Test your function by calling it with the parameters ð‘š = 8, ð‘Ž = 5, ð‘ = 1 and by comparing the output with the results from class.

```{r}
# TODO:
```

------------------------------------------------------------------------

## 5.

Given a sequence ð‘‹1, ð‘‹2, â€¦ , ð‘‹ð‘› of ð‘ˆ[0,1]- distributed PRN, we can use a scatter plot of (ð‘‹ð‘– ,ð‘‹ð‘–+1 ) for ð‘– = 1, â€¦ , ð‘› âˆ’ 1 in order to try to assess whether the ð‘‹ð‘– are independent.

### A. Create such a plot using the built in random number generator in R. Can you explain the resulting plot.

```{r}
# TODO:
```

### B. Create a similar plot using your function from exercise 1 with ð‘š = 81, ð‘Ž = 1, ð‘ = 8 and seed 0. Discuss the resulting plot.

```{r}
# TODO:
```

### C. Repeat the experiment from (b) using the parameters ð‘š = 1024, ð‘Ž = 401, ð‘ = 101 and ð‘š = 2\^32, ð‘Ž = 1664525, ð‘ = 1013904223. Discuss the results.

```{r}
# TODO:
```

------------------------------------------------------------------------

## 6.

Simulate a Drunkard's walk in two dimensions. The Drunkard's walk is a random process where at each step, the walker randomly chooses one of eight possible directions (North, South, East, West, Northeast, Southeast, Southwest, Northwest) with varying probabilities. Your task is to implement the simulation according to the following specifications:

### A. Define a vector named probabilities representing the probabilities of moving in each direction:

-   North: 10%
-   South: 15%
-   East: 15%
-   West: 20%
-   Northeast: 10%
-   Southeast: 10%
-   Southwest: 10%
-   Northwest: 10%

```{r}
# TODO:
```

### B. Write a function named simulate_step that simulates one step of the drunkard's walk:

The function should randomly select one of the eight directions based on the specified probabilities. It should return a vector representing the step in the chosen direction, where the first element indicates the change in the x-coordinate (East/West) and the second element indicates the change in the y-coordinate (North/South).

```{r}
# TODO:
```

### C. Simulate the drunkard's walk for a total of 1000 steps. Initialize a matrix named positions with dimensions (1001, 2) to store the positions of the drunkard at each step. Use a for loop to iteratively call the simulate_step function and update the drunkard's position accordingly.

```{r}
# TODO:
```

### D. Plot the path of the drunkard's walk in two dimensions. Use the plot function to create a line plot of the positions. Mark the starting point in red and the ending point in blue.

```{r}
# TODO:
```

